<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>watch 2: components/arduino-esp32/libraries/BLE/src/BLECharacteristic.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">watch 2
   </div>
   <div id="projectbrief">Firmwareforwatch2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_5eb99044ce905dee52e93bf33cea5db4.html">arduino-esp32</a></li><li class="navelem"><a class="el" href="dir_0b98385dcf64e929fcaa5e8c894594ea.html">libraries</a></li><li class="navelem"><a class="el" href="dir_62153437fabe5cbff8551516e71e90d9.html">BLE</a></li><li class="navelem"><a class="el" href="dir_6da50d77600cfeb770f70e1abc938cb6.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BLECharacteristic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BLECharacteristic_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * BLECharacteristic.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Jun 22, 2017</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#if defined(CONFIG_BT_ENABLED)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="esp__err_8h.html">esp_err.h</a>&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BLECharacteristic_8h.html">BLECharacteristic.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BLEService_8h.html">BLEService.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BLEDevice_8h.html">BLEDevice.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BLEUtils_8h.html">BLEUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BLE2902_8h.html">BLE2902.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GeneralUtils_8h.html">GeneralUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="esp32-hal-log_8h.html">esp32-hal-log.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define NULL_HANDLE (0xffff)</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">static</span> BLECharacteristicCallbacks defaultCallback; <span class="comment">//null-object-pattern</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;BLECharacteristic::BLECharacteristic(<span class="keyword">const</span> <span class="keywordtype">char</span>* uuid, <a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> <a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a>) : BLECharacteristic(BLEUUID(uuid), <a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a>) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;BLECharacteristic::BLECharacteristic(BLEUUID uuid, <a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> <a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    m_bleUUID    = uuid;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    m_handle     = NULL_HANDLE;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    m_pCallbacks = &amp;defaultCallback;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    setBroadcastProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_BROADCAST) != 0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    setReadProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_READ) != 0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    setWriteProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_WRITE) != 0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    setNotifyProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_NOTIFY) != 0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    setIndicateProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_INDICATE) != 0);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    setWriteNoResponseProperty((<a class="code" href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a> &amp; PROPERTY_WRITE_NR) != 0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;} <span class="comment">// BLECharacteristic</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;BLECharacteristic::~BLECharacteristic() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//free(m_value.attr_value); // Release the storage for the value.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;} <span class="comment">// ~BLECharacteristic</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::addDescriptor(BLEDescriptor* pDescriptor) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; addDescriptor(): Adding %s to %s&quot;</span>, pDescriptor-&gt;toString().c_str(), toString().c_str());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    m_descriptorMap.setByUUID(pDescriptor-&gt;getUUID(), pDescriptor);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; addDescriptor()&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;} <span class="comment">// addDescriptor</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::executeCreate(BLEService* pService) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; executeCreate()&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (m_handle != NULL_HANDLE) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;Characteristic already has a handle.&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    m_pService = pService; <span class="comment">// Save the service to which this characteristic belongs.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;Registering characteristic (esp_ble_gatts_add_char): uuid: %s, service: %s&quot;</span>,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        getUUID().toString().c_str(),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        m_pService-&gt;toString().c_str());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="structesp__attr__control__t.html">esp_attr_control_t</a> control;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    control.<a class="code" href="structesp__attr__control__t.html#a9bbeff926aa91e1f8f14d2fdbfed9c67">auto_rsp</a> = <a class="code" href="esp__gatt__defs_8h.html#a0d46fc0708038b839c4b4e94e73d2a7c">ESP_GATT_RSP_BY_APP</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    m_semaphoreCreateEvt.take(<span class="stringliteral">&quot;executeCreate&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a> errRc = <a class="code" href="esp__gatts__api_8h.html#ab6874c83bc627cd6ceb2813d46fe9981">::esp_ble_gatts_add_char</a>(</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        m_pService-&gt;getHandle(),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        getUUID().getNative(),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="esp__gatt__defs_8h.html#acff6cd93a5fb5e46e40a47a6a053d7ae">esp_gatt_perm_t</a><span class="keyword">&gt;</span>(m_permissions),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        getProperties(),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        &amp;control); <span class="comment">// Whether to auto respond or not.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (errRc != <a class="code" href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a>) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;&lt;&lt; esp_ble_gatts_add_char: rc=%d %s&quot;</span>, errRc, <a class="code" href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    m_semaphoreCreateEvt.wait(<span class="stringliteral">&quot;executeCreate&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    BLEDescriptor* pDescriptor = m_descriptorMap.getFirst();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">while</span> (pDescriptor != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        pDescriptor-&gt;executeCreate(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        pDescriptor = m_descriptorMap.getNext();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    } <span class="comment">// End while</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; executeCreate&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;} <span class="comment">// executeCreate</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;BLEDescriptor* BLECharacteristic::getDescriptorByUUID(<span class="keyword">const</span> <span class="keywordtype">char</span>* descriptorUUID) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span> m_descriptorMap.getByUUID(BLEUUID(descriptorUUID));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;} <span class="comment">// getDescriptorByUUID</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;BLEDescriptor* BLECharacteristic::getDescriptorByUUID(BLEUUID descriptorUUID) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> m_descriptorMap.getByUUID(descriptorUUID);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;} <span class="comment">// getDescriptorByUUID</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a> BLECharacteristic::getHandle() {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span> m_handle;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;} <span class="comment">// getHandle</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setAccessPermissions(<a class="code" href="esp__gatt__defs_8h.html#acff6cd93a5fb5e46e40a47a6a053d7ae">esp_gatt_perm_t</a> perm) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    m_permissions = perm;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a> BLECharacteristic::getProperties() {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> m_properties;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;} <span class="comment">// getProperties</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;BLEService* BLECharacteristic::getService() {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> m_pService;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;} <span class="comment">// getService</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;BLEUUID BLECharacteristic::getUUID() {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> m_bleUUID;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;} <span class="comment">// getUUID</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> BLECharacteristic::getValue() {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> m_value.getValue();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;} <span class="comment">// getValue</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>* BLECharacteristic::getData() {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> m_value.getData();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;} <span class="comment">// getData</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::handleGATTServerEvent(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7">esp_gatts_cb_event_t</a>      <a class="code" href="namespaceasio_1_1detail.html#a83969c12552b8b4db0c39a9efd1e0e25">event</a>,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="esp__gatt__defs_8h.html#a7c8ff38d8499f5c03b86d4b7e5d82ee4">esp_gatt_if_t</a>             gatts_if,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="unionesp__ble__gatts__cb__param__t.html">esp_ble_gatts_cb_param_t</a>* <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; handleGATTServerEvent: %s&quot;</span>, BLEUtils::gattServerEventTypeToString(<a class="code" href="namespaceasio_1_1detail.html#a83969c12552b8b4db0c39a9efd1e0e25">event</a>).c_str());</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="namespaceasio_1_1detail.html#a83969c12552b8b4db0c39a9efd1e0e25">event</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Events handled:</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// ESP_GATTS_ADD_CHAR_EVT</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// ESP_GATTS_CONF_EVT</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// ESP_GATTS_CONNECT_EVT</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// ESP_GATTS_DISCONNECT_EVT</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// ESP_GATTS_READ_EVT</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// ESP_GATTS_WRITE_EVT</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// When we receive this event it is an indication that a previous write long needs to be committed.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// exec_write:</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// - uint16_t conn_id</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// - uint32_t trans_id</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// - uint8_t exec_write_flag - Either ESP_GATT_PREP_WRITE_EXEC or ESP_GATT_PREP_WRITE_CANCEL</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7ad9d87516f752482aadb6e1780286c6f3">ESP_GATTS_EXEC_WRITE_EVT</a>: {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;exec_write.exec_write_flag == <a class="code" href="esp__gatt__defs_8h.html#aa6455f33d21d1872dfbddca130f65f5dae281c1f16f73776a0c2ab3f674d3a600">ESP_GATT_PREP_WRITE_EXEC</a>) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                m_value.commit();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                m_pCallbacks-&gt;onWrite(<span class="keyword">this</span>); <span class="comment">// Invoke the onWrite callback handler.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                m_value.cancel();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">// ???</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a> errRc = <a class="code" href="esp__gatts__api_8h.html#a91c92e68dfff55ff34a42e63cc73a648">::esp_ble_gatts_send_response</a>(</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    gatts_if,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.conn_id,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.trans_id, <a class="code" href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896">ESP_GATT_OK</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">if</span> (errRc != <a class="code" href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        } <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// ESP_GATTS_ADD_CHAR_EVT - Indicate that a characteristic was added to the service.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// add_char:</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// - uint16_t attr_handle</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// - uint16_t service_handle</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// - esp_bt_uuid_t char_uuid</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a51490e359d1ed9d395d338b97b2808b9">ESP_GATTS_ADD_CHAR_EVT</a>: {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">if</span> (getHandle() == <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;add_char.attr_handle) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="comment">// we have created characteristic, now we can create descriptors</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">// BLEDescriptor* pDescriptor = m_descriptorMap.getFirst();</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="comment">// while (pDescriptor != nullptr) {</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="comment">//  pDescriptor-&gt;executeCreate(this);</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="comment">//  pDescriptor = m_descriptorMap.getNext();</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="comment">// } // End while</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                m_semaphoreCreateEvt.give();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        } <span class="comment">// ESP_GATTS_ADD_CHAR_EVT</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// ESP_GATTS_WRITE_EVT - A request to write the value of a characteristic has arrived.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// write:</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// - uint16_t      conn_id</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">// - uint16_t      trans_id</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">// - uint16_t      handle</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// - uint16_t      offset</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// - bool          need_rsp</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// - bool          is_prep</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// - uint16_t      len</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// - uint8_t      *value</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a01f3b302428562a33f51b881c80d915e">ESP_GATTS_WRITE_EVT</a>: {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">// We check if this write request is for us by comparing the handles in the event.  If it is for us</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">// we save the new value.  Next we look at the need_rsp flag which indicates whether or not we need</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">// to send a response.  If we do, then we formulate a response and send it.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.handle == m_handle) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.is_prep) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    m_value.addPart(<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.value, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    setValue(<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.value, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot; - Response to write event: New value: handle: %.2x, uuid: %s&quot;</span>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        getHandle(), getUUID().toString().c_str());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordtype">char</span>* pHexData = BLEUtils::buildHexData(<span class="keyword">nullptr</span>, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.value, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot; - Data: length: %d, data: %s&quot;</span>, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len, pHexData);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(pHexData);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.need_rsp) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="unionesp__gatt__rsp__t.html">esp_gatt_rsp_t</a> rsp;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>      = <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a29afcac3ff2ce2767029726aa74cf603">handle</a>   = m_handle;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a>   = <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.offset;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a5728bc39297713b542efa44eda903d9a">auth_req</a> = <a class="code" href="esp__gatt__defs_8h.html#aa0c6dedad96ebf721ca0244c1d290b2ba8e29fcebc835d550c06d28faa1221f6f">ESP_GATT_AUTH_REQ_NONE</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    memcpy(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.value, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.len);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <a class="code" href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a> errRc = <a class="code" href="esp__gatts__api_8h.html#a91c92e68dfff55ff34a42e63cc73a648">::esp_ble_gatts_send_response</a>(</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            gatts_if,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                            <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.conn_id,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                            <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.trans_id, <a class="code" href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896">ESP_GATT_OK</a>, &amp;rsp);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <span class="keywordflow">if</span> (errRc != <a class="code" href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                } <span class="comment">// Response needed</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;write.is_prep != <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    m_pCallbacks-&gt;onWrite(<span class="keyword">this</span>); <span class="comment">// Invoke the onWrite callback handler.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            } <span class="comment">// Match on handles.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        } <span class="comment">// ESP_GATTS_WRITE_EVT</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// ESP_GATTS_READ_EVT - A request to read the value of a characteristic has arrived.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// read:</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// - uint16_t      conn_id</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// - uint32_t      trans_id</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// - uint16_t      handle</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// - uint16_t      offset</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// - bool          is_long</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// - bool          need_rsp</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a397760d0171849ad998bfc48f13afc37">ESP_GATTS_READ_EVT</a>: {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.handle == m_handle) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// Here&#39;s an interesting thing.  The read request has the option of saying whether we need a response</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">// or not.  What would it &quot;mean&quot; to receive a read request and NOT send a response back?  That feels like</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">// a very strange read.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">// We have to handle the case where the data we wish to send back to the client is greater than the maximum</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">// packet size of 22 bytes.  In this case, we become responsible for chunking the data into units of 22 bytes.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">// The apparent algorithm is as follows:</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">// If the is_long flag is set then this is a follow on from an original read and we will already have sent at least 22 bytes.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">// If the is_long flag is not set then we need to check how much data we are going to send.  If we are sending LESS than</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">// 22 bytes, then we &quot;just&quot; send it and thats the end of the story.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">// If we are sending 22 bytes exactly, we just send it BUT we will get a follow on request.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">// If we are sending more than 22 bytes, we send the first 22 bytes and we will get a follow on request.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">// Because of follow on request processing, we need to maintain an offset of how much data we have already sent</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">// so that when a follow on request arrives, we know where to start in the data to send the next sequence.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// Note that the indication that the client will send a follow on request is that we sent exactly 22 bytes as a response.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">// If our payload is divisible by 22 then the last response will be a response of 0 bytes in length.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">// The following code has deliberately not been factored to make it fewer statements because this would cloud the</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">// the logic flow comprehension.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="comment">// get mtu for peer device that we are sending read request to</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a> maxOffset =  getService()-&gt;getServer()-&gt;getPeerMTU(<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.conn_id) - 1;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;mtu value: %d&quot;</span>, maxOffset);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.need_rsp) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;Sending a response (esp_ble_gatts_send_response)&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    <a class="code" href="unionesp__gatt__rsp__t.html">esp_gatt_rsp_t</a> rsp;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.is_long) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                        <a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a> = m_value.getValue();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.length() - m_value.getReadOffset() &lt; maxOffset) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            <span class="comment">// This is the last in the chain</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>    = <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.length() - m_value.getReadOffset();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a> = m_value.getReadOffset();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                            memcpy(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.data() + rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a>, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                            m_value.setReadOffset(0);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                            <span class="comment">// There will be more to come.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>    = maxOffset;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a> = m_value.getReadOffset();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                            memcpy(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.data() + rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a>, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                            m_value.setReadOffset(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a> + maxOffset);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// read.is_long == false</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <span class="comment">// If is.long is false then this is the first (or only) request to read data, so invoke the callback</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        <span class="comment">// Invoke the read callback.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        m_pCallbacks-&gt;onRead(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        <a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a> = m_value.getValue();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.length() + 1 &gt; maxOffset) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                            <span class="comment">// Too big for a single shot entry.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                            m_value.setReadOffset(maxOffset);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>    = maxOffset;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a> = 0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                            memcpy(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.data(), rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                            <span class="comment">// Will fit in a single packet with no callbacks required.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>    = <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.length();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a> = 0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            memcpy(rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.data(), rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a29afcac3ff2ce2767029726aa74cf603">handle</a>   = <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.handle;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a5728bc39297713b542efa44eda903d9a">auth_req</a> = <a class="code" href="esp__gatt__defs_8h.html#aa0c6dedad96ebf721ca0244c1d290b2ba8e29fcebc835d550c06d28faa1221f6f">ESP_GATT_AUTH_REQ_NONE</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    <span class="keywordtype">char</span> *pHexData = BLEUtils::buildHexData(<span class="keyword">nullptr</span>, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">value</a>, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot; - Data: length=%d, data=%s, offset=%d&quot;</span>, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">len</a>, pHexData, rsp.<a class="code" href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">attr_value</a>.<a class="code" href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">offset</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(pHexData);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    <a class="code" href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a> errRc = <a class="code" href="esp__gatts__api_8h.html#a91c92e68dfff55ff34a42e63cc73a648">::esp_ble_gatts_send_response</a>(</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            gatts_if, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.conn_id,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;read.trans_id,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            <a class="code" href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896">ESP_GATT_OK</a>,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            &amp;rsp);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <span class="keywordflow">if</span> (errRc != <a class="code" href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a>) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                } <span class="comment">// Response needed</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            } <span class="comment">// Handle matches this characteristic.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        } <span class="comment">// ESP_GATTS_READ_EVT</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">// ESP_GATTS_CONF_EVT</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">// conf:</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">// - esp_gatt_status_t status  – The status code.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// - uint16_t          conn_id – The connection used.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a4b985813db56a4652e83d80759e13e47">ESP_GATTS_CONF_EVT</a>: {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">// log_d(&quot;m_handle = %d, conf-&gt;handle = %d&quot;, m_handle, param-&gt;conf.handle);</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;conf.conn_id == getService()-&gt;getServer()-&gt;getConnId()) <span class="comment">// &amp;&amp; param-&gt;conf.handle == m_handle) // bug in esp-idf and not implemented in arduino yet</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                m_semaphoreConfEvt.give(<a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>-&gt;conf.status);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a6ca335f3c86d20e0524c296d8ac78b38">ESP_GATTS_CONNECT_EVT</a>: {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a25e6c3dadd90a9538a0880723bfda97c">ESP_GATTS_DISCONNECT_EVT</a>: {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            m_semaphoreConfEvt.give();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        } <span class="comment">// default</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    } <span class="comment">// switch event</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// Give each of the descriptors associated with this characteristic the opportunity to handle the</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// event.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    m_descriptorMap.handleGATTServerEvent(<a class="code" href="namespaceasio_1_1detail.html#a83969c12552b8b4db0c39a9efd1e0e25">event</a>, gatts_if, <a class="code" href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; handleGATTServerEvent&quot;</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;} <span class="comment">// handleGATTServerEvent</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::indicate() {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; indicate: length: %d&quot;</span>, m_value.getValue().length());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    notify(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; indicate&quot;</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;} <span class="comment">// indicate</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::notify(<span class="keywordtype">bool</span> is_notification) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; notify: length: %d&quot;</span>, m_value.getValue().length());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="components_2arduino-esp32_2tools_2sdk_2include_2newlib_2assert_8h.html#a7bbc469eb189fd98eead7ce1691dce53">assert</a>(getService() != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="components_2arduino-esp32_2tools_2sdk_2include_2newlib_2assert_8h.html#a7bbc469eb189fd98eead7ce1691dce53">assert</a>(getService()-&gt;getServer() != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    m_pCallbacks-&gt;onNotify(<span class="keyword">this</span>);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="classGeneralUtils.html#a0624d2bba035e50c4073074da675a606">GeneralUtils::hexDump</a>((<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>*)m_value.getValue().data(), m_value.getValue().length());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (getService()-&gt;getServer()-&gt;getConnectedCount() == 0) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; notify: No connected clients.&quot;</span>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_NO_CLIENT, 0);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// Test to see if we have a 0x2902 descriptor.  If we do, then check to see if notification is enabled</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// and, if not, prevent the notification.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    BLE2902 *p2902 = (BLE2902*)getDescriptorByUUID((<a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a>)0x2902);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span>(is_notification) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> (p2902 != <span class="keyword">nullptr</span> &amp;&amp; !p2902-&gt;getNotifications()) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; notifications disabled; ignoring&quot;</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_NOTIFY_DISABLED, 0);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">if</span> (p2902 != <span class="keyword">nullptr</span> &amp;&amp; !p2902-&gt;getIndications()) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; indications disabled; ignoring&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_INDICATE_DISABLED, 0);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : getService()-&gt;getServer()-&gt;getPeerDevices(<span class="keyword">false</span>)) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a> _mtu = (myPair.second.mtu);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (m_value.getValue().length() &gt; _mtu - 3) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <a class="code" href="esp32-hal-log_8h.html#a71c957bc93270caaa91f41f6989c317b">log_w</a>(<span class="stringliteral">&quot;- Truncating to %d bytes (maximum notify size)&quot;</span>, _mtu - 3);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a> = m_value.getValue().length();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span>(!is_notification) <span class="comment">// is indication</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            m_semaphoreConfEvt.take(<span class="stringliteral">&quot;indicate&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a> errRc = <a class="code" href="esp__gatts__api_8h.html#a3ba96ab6391571f42f99038be49cb37c">::esp_ble_gatts_send_indicate</a>(</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                getService()-&gt;getServer()-&gt;getGattsIf(),</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                myPair.first,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                getHandle(), <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>, (<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>*)m_value.getValue().data(), !is_notification); <span class="comment">// The need_confirm = false makes this a notify.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (errRc != <a class="code" href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a>) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;&lt;&lt; esp_ble_gatts_send_ %s: rc=%d %s&quot;</span>,is_notification?<span class="stringliteral">&quot;notify&quot;</span>:<span class="stringliteral">&quot;indicate&quot;</span>, errRc, <a class="code" href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            m_semaphoreConfEvt.give();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_GATT, errRc);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">if</span>(!is_notification){ <span class="comment">// is indication</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">if</span>(!m_semaphoreConfEvt.timedWait(<span class="stringliteral">&quot;indicate&quot;</span>, indicationTimeout)){</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_INDICATE_TIMEOUT, 0);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keyword">auto</span> <a class="code" href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a> = (<a class="code" href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0d">esp_gatt_status_t</a>) m_semaphoreConfEvt.value();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a> == <a class="code" href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896">ESP_GATT_OK</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::SUCCESS_INDICATE, <a class="code" href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a>);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::ERROR_INDICATE_FAILURE, <a class="code" href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            m_pCallbacks-&gt;onStatus(<span class="keyword">this</span>, BLECharacteristicCallbacks::Status::SUCCESS_NOTIFY, 0);   <span class="comment">// Invoke the notify callback.</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; notify&quot;</span>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;} <span class="comment">// Notify</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setBroadcastProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">//log_d(&quot;setBroadcastProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#a1d09c06b2e5e49f203da439756b02e27">ESP_GATT_CHAR_PROP_BIT_BROADCAST</a>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#a1d09c06b2e5e49f203da439756b02e27">ESP_GATT_CHAR_PROP_BIT_BROADCAST</a>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;} <span class="comment">// setBroadcastProperty</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setCallbacks(BLECharacteristicCallbacks* pCallbacks) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; setCallbacks: 0x%x&quot;</span>, (<a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>)pCallbacks);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (pCallbacks != <span class="keyword">nullptr</span>){</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        m_pCallbacks = pCallbacks;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        m_pCallbacks = &amp;defaultCallback;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; setCallbacks&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;} <span class="comment">// setCallbacks</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setHandle(<a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a> handle) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; setHandle: handle=0x%.2x, characteristic uuid=%s&quot;</span>, handle, getUUID().toString().c_str());</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    m_handle = handle;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; setHandle&quot;</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;} <span class="comment">// setHandle</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setIndicateProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">//log_d(&quot;setIndicateProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#a51b1bd69b30215eed035c5b118816d50">ESP_GATT_CHAR_PROP_BIT_INDICATE</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#a51b1bd69b30215eed035c5b118816d50">ESP_GATT_CHAR_PROP_BIT_INDICATE</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;} <span class="comment">// setIndicateProperty</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setNotifyProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">//log_d(&quot;setNotifyProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#a0b3963c9f6fa8c3bb7545e72f5b39bd2">ESP_GATT_CHAR_PROP_BIT_NOTIFY</a>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#a0b3963c9f6fa8c3bb7545e72f5b39bd2">ESP_GATT_CHAR_PROP_BIT_NOTIFY</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;} <span class="comment">// setNotifyProperty</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setReadProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">//log_d(&quot;setReadProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#a83259cd7465fba1aebeeaea5be774080">ESP_GATT_CHAR_PROP_BIT_READ</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#a83259cd7465fba1aebeeaea5be774080">ESP_GATT_CHAR_PROP_BIT_READ</a>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;} <span class="comment">// setReadProperty</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>* <a class="code" href="namespaceudp__server.html#ade67d79c46c11d44cd799213c5a772ca">data</a>, <span class="keywordtype">size_t</span> <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">char</span>* pHex = BLEUtils::buildHexData(<span class="keyword">nullptr</span>, <a class="code" href="namespaceudp__server.html#ade67d79c46c11d44cd799213c5a772ca">data</a>, <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&gt;&gt; setValue: length=%d, data=%s, characteristic UUID=%s&quot;</span>, <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>, pHex, getUUID().toString().c_str());</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(pHex);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a> &gt; <a class="code" href="esp__gatt__defs_8h.html#aec5bb618d6a8bbc3bc14e7162785030c">ESP_GATT_MAX_ATTR_LEN</a>) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a>(<span class="stringliteral">&quot;Size %d too large, must be no bigger than %d&quot;</span>, <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>, <a class="code" href="esp__gatt__defs_8h.html#aec5bb618d6a8bbc3bc14e7162785030c">ESP_GATT_MAX_ATTR_LEN</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    m_semaphoreSetValue.take();  </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    m_value.setValue(<a class="code" href="namespaceudp__server.html#ade67d79c46c11d44cd799213c5a772ca">data</a>, <a class="code" href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    m_semaphoreSetValue.give();  </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a>(<span class="stringliteral">&quot;&lt;&lt; setValue&quot;</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    setValue((<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>*)(<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.data()), <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>.length());</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<a class="code" href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a>&amp; data16) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a> <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2];</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data16;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data16 &gt;&gt; 8;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    setValue(<a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 2);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&amp; data32) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a> <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[4];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data32;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data32 &gt;&gt; 8;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2] = data32 &gt;&gt; 16;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[3] = data32 &gt;&gt; 24;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    setValue(<a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<span class="keywordtype">int</span>&amp; data32) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a> <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[4];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data32;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data32 &gt;&gt; 8;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2] = data32 &gt;&gt; 16;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[3] = data32 &gt;&gt; 24;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    setValue(<a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<span class="keywordtype">float</span>&amp; data32) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a> = data32;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    setValue((<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>*)&amp;<a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setValue(<span class="keywordtype">double</span>&amp; data64) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a> = data64;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    setValue((<a class="code" href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a>*)&amp;<a class="code" href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 8);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;} <span class="comment">// setValue</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setWriteNoResponseProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">//log_d(&quot;setWriteNoResponseProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#a2db17b72d1ed61a506188acc6f22e0fc">ESP_GATT_CHAR_PROP_BIT_WRITE_NR</a>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#a2db17b72d1ed61a506188acc6f22e0fc">ESP_GATT_CHAR_PROP_BIT_WRITE_NR</a>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;} <span class="comment">// setWriteNoResponseProperty</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setWriteProperty(<span class="keywordtype">bool</span> <a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">//log_d(&quot;setWriteProperty(%d)&quot;, value);</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a>) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties | <a class="code" href="esp__gatt__defs_8h.html#ad758f074d4349e8bf0008f14f7b615b2">ESP_GATT_CHAR_PROP_BIT_WRITE</a>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        m_properties = (<a class="code" href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a>)(m_properties &amp; ~<a class="code" href="esp__gatt__defs_8h.html#ad758f074d4349e8bf0008f14f7b615b2">ESP_GATT_CHAR_PROP_BIT_WRITE</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;} <span class="comment">// setWriteProperty</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> BLECharacteristic::toString() {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">std::string</a> res = <span class="stringliteral">&quot;UUID: &quot;</span> + m_bleUUID.toString() + <span class="stringliteral">&quot;, handle : 0x&quot;</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="ios_8h.html#ace2036d970905192360d622140bfe336">hex</a>[5];</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    snprintf(<a class="code" href="ios_8h.html#ace2036d970905192360d622140bfe336">hex</a>, <span class="keyword">sizeof</span>(<a class="code" href="ios_8h.html#ace2036d970905192360d622140bfe336">hex</a>), <span class="stringliteral">&quot;%04x&quot;</span>, m_handle);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    res += <a class="code" href="ios_8h.html#ace2036d970905192360d622140bfe336">hex</a>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    res += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#a83259cd7465fba1aebeeaea5be774080">ESP_GATT_CHAR_PROP_BIT_READ</a>) res += <span class="stringliteral">&quot;Read &quot;</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#ad758f074d4349e8bf0008f14f7b615b2">ESP_GATT_CHAR_PROP_BIT_WRITE</a>) res += <span class="stringliteral">&quot;Write &quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#a2db17b72d1ed61a506188acc6f22e0fc">ESP_GATT_CHAR_PROP_BIT_WRITE_NR</a>) res += <span class="stringliteral">&quot;WriteNoResponse &quot;</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#a1d09c06b2e5e49f203da439756b02e27">ESP_GATT_CHAR_PROP_BIT_BROADCAST</a>) res += <span class="stringliteral">&quot;Broadcast &quot;</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#a0b3963c9f6fa8c3bb7545e72f5b39bd2">ESP_GATT_CHAR_PROP_BIT_NOTIFY</a>) res += <span class="stringliteral">&quot;Notify &quot;</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span> (m_properties &amp; <a class="code" href="esp__gatt__defs_8h.html#a51b1bd69b30215eed035c5b118816d50">ESP_GATT_CHAR_PROP_BIT_INDICATE</a>) res += <span class="stringliteral">&quot;Indicate &quot;</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;} <span class="comment">// toString</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;BLECharacteristicCallbacks::~BLECharacteristicCallbacks() {}</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="keywordtype">void</span> BLECharacteristicCallbacks::onRead(BLECharacteristic* pCharacteristic) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onRead: default&quot;</span>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onRead&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;} <span class="comment">// onRead</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordtype">void</span> BLECharacteristicCallbacks::onWrite(BLECharacteristic* pCharacteristic) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onWrite: default&quot;</span>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onWrite&quot;</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;} <span class="comment">// onWrite</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="keywordtype">void</span> BLECharacteristicCallbacks::onNotify(BLECharacteristic* pCharacteristic) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onNotify: default&quot;</span>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onNotify&quot;</span>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;} <span class="comment">// onNotify</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordtype">void</span> BLECharacteristicCallbacks::onStatus(BLECharacteristic* pCharacteristic, Status <a class="code" href="namespaceudp__server.html#a4243778b598aedff036c5363970df861">s</a>, <a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> <a class="code" href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onStatus: default&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a>(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onStatus&quot;</span>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;} <span class="comment">// onStatus</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CONFIG_BT_ENABLED */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aesp__gatt__defs_8h_html_a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896"><div class="ttname"><a href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0da1397441d1486b772a30666523b66e896">ESP_GATT_OK</a></div><div class="ttdeci">@ ESP_GATT_OK</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00169">esp_gatt_defs.h:169</a></div></div>
<div class="ttc" id="anamespaceasio_1_1detail_html_a83969c12552b8b4db0c39a9efd1e0e25"><div class="ttname"><a href="namespaceasio_1_1detail.html#a83969c12552b8b4db0c39a9efd1e0e25">asio::detail::event</a></div><div class="ttdeci">null_event event</div><div class="ttdef"><b>Definition:</b> <a href="event_8hpp_source.html#l00036">event.hpp:36</a></div></div>
<div class="ttc" id="aios_8h_html_ace2036d970905192360d622140bfe336"><div class="ttname"><a href="ios_8h.html#ace2036d970905192360d622140bfe336">hex</a></div><div class="ttdeci">ios_base &amp; hex(ios_base &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="ios_8h_source.html#l00237">ios.h:237</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a965282ee75c1ff6f2e71b59955612ace"><div class="ttname"><a href="esp__gatt__defs_8h.html#a965282ee75c1ff6f2e71b59955612ace">esp_gatt_char_prop_t</a></div><div class="ttdeci">uint8_t esp_gatt_char_prop_t</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00287">esp_gatt_defs.h:287</a></div></div>
<div class="ttc" id="aesp32-hal-log_8h_html_a925f3f2d10368d16506845d280b1b7a1"><div class="ttname"><a href="esp32-hal-log_8h.html#a925f3f2d10368d16506845d280b1b7a1">log_v</a></div><div class="ttdeci">#define log_v(format,...)</div><div class="ttdef"><b>Definition:</b> <a href="esp32-hal-log_8h_source.html#l00085">esp32-hal-log.h:84</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_a3ba96ab6391571f42f99038be49cb37c"><div class="ttname"><a href="esp__gatts__api_8h.html#a3ba96ab6391571f42f99038be49cb37c">esp_ble_gatts_send_indicate</a></div><div class="ttdeci">esp_err_t esp_ble_gatts_send_indicate(esp_gatt_if_t gatts_if, uint16_t conn_id, uint16_t attr_handle, uint16_t value_len, uint8_t *value, bool need_confirm)</div><div class="ttdoc">Send indicate or notify to GATT client. Set param need_confirm as false will send notification,...</div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_a91c92e68dfff55ff34a42e63cc73a648"><div class="ttname"><a href="esp__gatts__api_8h.html#a91c92e68dfff55ff34a42e63cc73a648">esp_ble_gatts_send_response</a></div><div class="ttdeci">esp_err_t esp_ble_gatts_send_response(esp_gatt_if_t gatts_if, uint16_t conn_id, uint32_t trans_id, esp_gatt_status_t status, esp_gatt_rsp_t *rsp)</div><div class="ttdoc">This function is called to send a response to a request.</div></div>
<div class="ttc" id="astdint_8h_html_a281b4b5562236420969a830503b0ba19"><div class="ttname"><a href="stdint_8h.html#a281b4b5562236420969a830503b0ba19">uint16_t</a></div><div class="ttdeci">__uint16_t uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00033">stdint.h:33</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a01f3b302428562a33f51b881c80d915e"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a01f3b302428562a33f51b881c80d915e">ESP_GATTS_WRITE_EVT</a></div><div class="ttdeci">@ ESP_GATTS_WRITE_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00030">esp_gatts_api.h:30</a></div></div>
<div class="ttc" id="aBLEDevice_8h_html"><div class="ttname"><a href="BLEDevice_8h.html">BLEDevice.h</a></div></div>
<div class="ttc" id="acJSON_8h_html_addf925fe055723aa55a381a1ba45bda2"><div class="ttname"><a href="cJSON_8h.html#addf925fe055723aa55a381a1ba45bda2">string</a></div><div class="ttdeci">const char *const string</div><div class="ttdef"><b>Definition:</b> <a href="cJSON_8h_source.html#l00170">cJSON.h:170</a></div></div>
<div class="ttc" id="astructesp__gatt__value__t_html_a5728bc39297713b542efa44eda903d9a"><div class="ttname"><a href="structesp__gatt__value__t.html#a5728bc39297713b542efa44eda903d9a">esp_gatt_value_t::auth_req</a></div><div class="ttdeci">uint8_t auth_req</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00373">esp_gatt_defs.h:373</a></div></div>
<div class="ttc" id="aesp32-hal-log_8h_html"><div class="ttname"><a href="esp32-hal-log_8h.html">esp32-hal-log.h</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a0b3963c9f6fa8c3bb7545e72f5b39bd2"><div class="ttname"><a href="esp__gatt__defs_8h.html#a0b3963c9f6fa8c3bb7545e72f5b39bd2">ESP_GATT_CHAR_PROP_BIT_NOTIFY</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_NOTIFY</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00284">esp_gatt_defs.h:283</a></div></div>
<div class="ttc" id="anamespaceudp__server_html_ade67d79c46c11d44cd799213c5a772ca"><div class="ttname"><a href="namespaceudp__server.html#ade67d79c46c11d44cd799213c5a772ca">udp_server.data</a></div><div class="ttdeci">data</div><div class="ttdef"><b>Definition:</b> <a href="udp__server_8py_source.html#l00023">udp_server.py:23</a></div></div>
<div class="ttc" id="astructesp__attr__control__t_html_a9bbeff926aa91e1f8f14d2fdbfed9c67"><div class="ttname"><a href="structesp__attr__control__t.html#a9bbeff926aa91e1f8f14d2fdbfed9c67">esp_attr_control_t::auto_rsp</a></div><div class="ttdeci">uint8_t auto_rsp</div><div class="ttdoc">if auto_rsp set to ESP_GATT_RSP_BY_APP, means the response of Write/Read operation will by replied by...</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00323">esp_gatt_defs.h:323</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a6ca335f3c86d20e0524c296d8ac78b38"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a6ca335f3c86d20e0524c296d8ac78b38">ESP_GATTS_CONNECT_EVT</a></div><div class="ttdeci">@ ESP_GATTS_CONNECT_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00042">esp_gatts_api.h:42</a></div></div>
<div class="ttc" id="aesp32-hal-log_8h_html_a1de06c4fd79189513953309af5b5593a"><div class="ttname"><a href="esp32-hal-log_8h.html#a1de06c4fd79189513953309af5b5593a">log_d</a></div><div class="ttdeci">#define log_d(format,...)</div><div class="ttdef"><b>Definition:</b> <a href="esp32-hal-log_8h_source.html#l00093">esp32-hal-log.h:92</a></div></div>
<div class="ttc" id="aRPSL_8txt_html_ae227cfd33a5880ffce840d383c2fbff3"><div class="ttname"><a href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a></div><div class="ttdeci">Conditions &amp;Restrictions Subject to the terms and conditions of this Licensor hereby grants effective on the date You accept this a royalty free</div><div class="ttdef"><b>Definition:</b> <a href="RPSL_8txt_source.html#l00105">RPSL.txt:105</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_aec5bb618d6a8bbc3bc14e7162785030c"><div class="ttname"><a href="esp__gatt__defs_8h.html#aec5bb618d6a8bbc3bc14e7162785030c">ESP_GATT_MAX_ATTR_LEN</a></div><div class="ttdeci">#define ESP_GATT_MAX_ATTR_LEN</div><div class="ttdoc">GATT maximum attribute length.</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00291">esp_gatt_defs.h:290</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a7c8ff38d8499f5c03b86d4b7e5d82ee4"><div class="ttname"><a href="esp__gatt__defs_8h.html#a7c8ff38d8499f5c03b86d4b7e5d82ee4">esp_gatt_if_t</a></div><div class="ttdeci">uint8_t esp_gatt_if_t</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00392">esp_gatt_defs.h:392</a></div></div>
<div class="ttc" id="aunionesp__ble__gatts__cb__param__t_html"><div class="ttname"><a href="unionesp__ble__gatts__cb__param__t.html">esp_ble_gatts_cb_param_t</a></div><div class="ttdoc">Gatt server callback parameters union.</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00059">esp_gatts_api.h:59</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a397760d0171849ad998bfc48f13afc37"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a397760d0171849ad998bfc48f13afc37">ESP_GATTS_READ_EVT</a></div><div class="ttdeci">@ ESP_GATTS_READ_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00029">esp_gatts_api.h:29</a></div></div>
<div class="ttc" id="aesp__err_8h_html_abdbffa06442bc1fe3d65dbb8d17656d1"><div class="ttname"><a href="esp__err_8h.html#abdbffa06442bc1fe3d65dbb8d17656d1">ESP_OK</a></div><div class="ttdeci">#define ESP_OK</div><div class="ttdef"><b>Definition:</b> <a href="esp__err_8h_source.html#l00028">esp_err.h:27</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a25e6c3dadd90a9538a0880723bfda97c"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a25e6c3dadd90a9538a0880723bfda97c">ESP_GATTS_DISCONNECT_EVT</a></div><div class="ttdeci">@ ESP_GATTS_DISCONNECT_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00043">esp_gatts_api.h:43</a></div></div>
<div class="ttc" id="aBLECharacteristic_8h_html"><div class="ttname"><a href="BLECharacteristic_8h.html">BLECharacteristic.h</a></div></div>
<div class="ttc" id="aGeneralUtils_8h_html"><div class="ttname"><a href="GeneralUtils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="aBLEService_8h_html"><div class="ttname"><a href="BLEService_8h.html">BLEService.h</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a0d46fc0708038b839c4b4e94e73d2a7c"><div class="ttname"><a href="esp__gatt__defs_8h.html#a0d46fc0708038b839c4b4e94e73d2a7c">ESP_GATT_RSP_BY_APP</a></div><div class="ttdeci">#define ESP_GATT_RSP_BY_APP</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00318">esp_gatt_defs.h:317</a></div></div>
<div class="ttc" id="astructesp__attr__control__t_html"><div class="ttname"><a href="structesp__attr__control__t.html">esp_attr_control_t</a></div><div class="ttdoc">attribute auto response flag</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00315">esp_gatt_defs.h:316</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7ad9d87516f752482aadb6e1780286c6f3"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7ad9d87516f752482aadb6e1780286c6f3">ESP_GATTS_EXEC_WRITE_EVT</a></div><div class="ttdeci">@ ESP_GATTS_EXEC_WRITE_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00031">esp_gatts_api.h:31</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_acff6cd93a5fb5e46e40a47a6a053d7ae"><div class="ttname"><a href="esp__gatt__defs_8h.html#acff6cd93a5fb5e46e40a47a6a053d7ae">esp_gatt_perm_t</a></div><div class="ttdeci">uint16_t esp_gatt_perm_t</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00275">esp_gatt_defs.h:275</a></div></div>
<div class="ttc" id="aBLEEddystoneTLM_8h_html_a36142ddde297ed1d5577c81230997301"><div class="ttname"><a href="BLEEddystoneTLM_8h.html#a36142ddde297ed1d5577c81230997301">temp</a></div><div class="ttdeci">uint16_t temp</div><div class="ttdef"><b>Definition:</b> <a href="BLEEddystoneTLM_8h_source.html#l00003">BLEEddystoneTLM.h:3</a></div></div>
<div class="ttc" id="aRPSL_8txt_html_a9576caf4434896b9a4c18b2e108c9f6e"><div class="ttname"><a href="RPSL_8txt.html#a9576caf4434896b9a4c18b2e108c9f6e">properties</a></div><div class="ttdeci">claims of patents owned by or assigned to You taken alone or in combination with Original Code Compatible Source License means any one of the licenses listed on Exhibit B or at any code covered by any Compatible Source License that is used with Covered Code must be made readily available in Source Code format for royalty free use under the terms of the Compatible Source License or this License Contributor means any person or entity that creates or contributes to the creation of Modifications Covered Code means the Original the combination of Original Code and any and or any respective portions thereof Deploy means to sublicense or distribute Covered Code other than for Your internal research and and includes without any and all internal use or distribution of Covered Code within Your business or organization except for R &amp;D use and or Personal as well as direct or indirect sublicensing or distribution of Covered Code by You to any third party in any form or manner Derivative Work means either the Covered Code or any derivative work under United States copyright and including any work containing or including any portion of the Covered Code or either verbatim or with modifications and or translated into another language Derivative Work also includes any work which combines any portion of Covered Code or Modifications with code not otherwise governed by the terms of this License Externally Deploy means to Deploy the Covered Code in any way that may be accessed or used by anyone other than used to provide any services to anyone other than or used in any way to deliver any content to anyone other than whether the Covered Code is distributed to those made available as an application intended for use over a computer or used to provide services or otherwise deliver content to anyone other than You Interface means properties</div><div class="ttdef"><b>Definition:</b> <a href="RPSL_8txt_source.html#l00062">RPSL.txt:62</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a1a90887e4a9be7371e69513c288c6b0d"><div class="ttname"><a href="esp__gatt__defs_8h.html#a1a90887e4a9be7371e69513c288c6b0d">esp_gatt_status_t</a></div><div class="ttdeci">esp_gatt_status_t</div><div class="ttdoc">GATT success code and error codes.</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00168">esp_gatt_defs.h:168</a></div></div>
<div class="ttc" id="atag__strings_8h_html_a51f20d6b1b54a2eee3be0e8adc96a0ae"><div class="ttname"><a href="tag__strings_8h.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a></div><div class="ttdeci">param</div><div class="ttdef"><b>Definition:</b> <a href="tag__strings_8h_source.html#l00079">tag_strings.h:79</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ab6874c83bc627cd6ceb2813d46fe9981"><div class="ttname"><a href="esp__gatts__api_8h.html#ab6874c83bc627cd6ceb2813d46fe9981">esp_ble_gatts_add_char</a></div><div class="ttdeci">esp_err_t esp_ble_gatts_add_char(uint16_t service_handle, esp_bt_uuid_t *char_uuid, esp_gatt_perm_t perm, esp_gatt_char_prop_t property, esp_attr_value_t *char_val, esp_attr_control_t *control)</div><div class="ttdoc">This function is called to add a characteristic into a service.</div></div>
<div class="ttc" id="aBLE2902_8h_html"><div class="ttname"><a href="BLE2902_8h.html">BLE2902.h</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a4b985813db56a4652e83d80759e13e47"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a4b985813db56a4652e83d80759e13e47">ESP_GATTS_CONF_EVT</a></div><div class="ttdeci">@ ESP_GATTS_CONF_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00033">esp_gatts_api.h:33</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a1d09c06b2e5e49f203da439756b02e27"><div class="ttname"><a href="esp__gatt__defs_8h.html#a1d09c06b2e5e49f203da439756b02e27">ESP_GATT_CHAR_PROP_BIT_BROADCAST</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_BROADCAST</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00280">esp_gatt_defs.h:279</a></div></div>
<div class="ttc" id="aesp__err_8h_html_ae535f6066003e82408b58e12f6950868"><div class="ttname"><a href="esp__err_8h.html#ae535f6066003e82408b58e12f6950868">esp_err_t</a></div><div class="ttdeci">int32_t esp_err_t</div><div class="ttdef"><b>Definition:</b> <a href="esp__err_8h_source.html#l00024">esp_err.h:24</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a2db17b72d1ed61a506188acc6f22e0fc"><div class="ttname"><a href="esp__gatt__defs_8h.html#a2db17b72d1ed61a506188acc6f22e0fc">ESP_GATT_CHAR_PROP_BIT_WRITE_NR</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_WRITE_NR</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00282">esp_gatt_defs.h:281</a></div></div>
<div class="ttc" id="astdint_8h_html_a0238af00180b6d9278fa1c6aa790fdf4"><div class="ttname"><a href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a></div><div class="ttdeci">__uint32_t uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00045">stdint.h:45</a></div></div>
<div class="ttc" id="acJSON__Utils_8h_html_a0dff3c76a075649fa412b1c429ffe382"><div class="ttname"><a href="cJSON__Utils_8h.html#a0dff3c76a075649fa412b1c429ffe382">value</a></div><div class="ttdeci">const char *const const char *const const cJSON *const value</div><div class="ttdef"><b>Definition:</b> <a href="cJSON__Utils_8h_source.html#l00042">cJSON_Utils.h:42</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a51b1bd69b30215eed035c5b118816d50"><div class="ttname"><a href="esp__gatt__defs_8h.html#a51b1bd69b30215eed035c5b118816d50">ESP_GATT_CHAR_PROP_BIT_INDICATE</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_INDICATE</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00285">esp_gatt_defs.h:284</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_aa0c6dedad96ebf721ca0244c1d290b2ba8e29fcebc835d550c06d28faa1221f6f"><div class="ttname"><a href="esp__gatt__defs_8h.html#aa0c6dedad96ebf721ca0244c1d290b2ba8e29fcebc835d550c06d28faa1221f6f">ESP_GATT_AUTH_REQ_NONE</a></div><div class="ttdeci">@ ESP_GATT_AUTH_REQ_NONE</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00256">esp_gatt_defs.h:256</a></div></div>
<div class="ttc" id="aesp__err_8h_html"><div class="ttname"><a href="esp__err_8h.html">esp_err.h</a></div></div>
<div class="ttc" id="aclassGeneralUtils_html_a0624d2bba035e50c4073074da675a606"><div class="ttname"><a href="classGeneralUtils.html#a0624d2bba035e50c4073074da675a606">GeneralUtils::hexDump</a></div><div class="ttdeci">static void hexDump(const uint8_t *pData, uint32_t length)</div><div class="ttdoc">Dump a representation of binary data to the console.</div><div class="ttdef"><b>Definition:</b> <a href="GeneralUtils_8cpp_source.html#l00290">GeneralUtils.cpp:290</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_ad758f074d4349e8bf0008f14f7b615b2"><div class="ttname"><a href="esp__gatt__defs_8h.html#ad758f074d4349e8bf0008f14f7b615b2">ESP_GATT_CHAR_PROP_BIT_WRITE</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00283">esp_gatt_defs.h:282</a></div></div>
<div class="ttc" id="astructesp__gatt__value__t_html_ada4d59b1cbeb9b36642728c1045ac65c"><div class="ttname"><a href="structesp__gatt__value__t.html#ada4d59b1cbeb9b36642728c1045ac65c">esp_gatt_value_t::value</a></div><div class="ttdeci">uint8_t value[ESP_GATT_MAX_ATTR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00369">esp_gatt_defs.h:369</a></div></div>
<div class="ttc" id="aesp32-hal-log_8h_html_a71c957bc93270caaa91f41f6989c317b"><div class="ttname"><a href="esp32-hal-log_8h.html#a71c957bc93270caaa91f41f6989c317b">log_w</a></div><div class="ttdeci">#define log_w(format,...)</div><div class="ttdef"><b>Definition:</b> <a href="esp32-hal-log_8h_source.html#l00109">esp32-hal-log.h:108</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_aa6455f33d21d1872dfbddca130f65f5dae281c1f16f73776a0c2ab3f674d3a600"><div class="ttname"><a href="esp__gatt__defs_8h.html#aa6455f33d21d1872dfbddca130f65f5dae281c1f16f73776a0c2ab3f674d3a600">ESP_GATT_PREP_WRITE_EXEC</a></div><div class="ttdeci">@ ESP_GATT_PREP_WRITE_EXEC</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00161">esp_gatt_defs.h:161</a></div></div>
<div class="ttc" id="aunionesp__gatt__rsp__t_html"><div class="ttname"><a href="unionesp__gatt__rsp__t.html">esp_gatt_rsp_t</a></div><div class="ttdoc">GATT remote read request response type.</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00377">esp_gatt_defs.h:377</a></div></div>
<div class="ttc" id="aunionesp__gatt__rsp__t_html_a62f2c010b3d722cc9c236a658184916e"><div class="ttname"><a href="unionesp__gatt__rsp__t.html#a62f2c010b3d722cc9c236a658184916e">esp_gatt_rsp_t::attr_value</a></div><div class="ttdeci">esp_gatt_value_t attr_value</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00378">esp_gatt_defs.h:378</a></div></div>
<div class="ttc" id="astructesp__gatt__value__t_html_a91260cb912cc0147cd3991c4acdbd107"><div class="ttname"><a href="structesp__gatt__value__t.html#a91260cb912cc0147cd3991c4acdbd107">esp_gatt_value_t::offset</a></div><div class="ttdeci">uint16_t offset</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00371">esp_gatt_defs.h:371</a></div></div>
<div class="ttc" id="acJSON_8h_html_a03c83e0884e2e3a1783db79f2d67101f"><div class="ttname"><a href="cJSON_8h.html#a03c83e0884e2e3a1783db79f2d67101f">length</a></div><div class="ttdeci">char const int length</div><div class="ttdef"><b>Definition:</b> <a href="cJSON_8h_source.html#l00161">cJSON.h:161</a></div></div>
<div class="ttc" id="atag__strings_8h_html_afa2765f9f647ea2e9c46055f93a44d41"><div class="ttname"><a href="tag__strings_8h.html#afa2765f9f647ea2e9c46055f93a44d41">code</a></div><div class="ttdeci">code</div><div class="ttdef"><b>Definition:</b> <a href="tag__strings_8h_source.html#l00054">tag_strings.h:54</a></div></div>
<div class="ttc" id="aesp32-hal-log_8h_html_a202330fb3201c41b86ad5a4700e529df"><div class="ttname"><a href="esp32-hal-log_8h.html#a202330fb3201c41b86ad5a4700e529df">log_e</a></div><div class="ttdeci">#define log_e(format,...)</div><div class="ttdef"><b>Definition:</b> <a href="esp32-hal-log_8h_source.html#l00117">esp32-hal-log.h:116</a></div></div>
<div class="ttc" id="astructesp__gatt__value__t_html_a29afcac3ff2ce2767029726aa74cf603"><div class="ttname"><a href="structesp__gatt__value__t.html#a29afcac3ff2ce2767029726aa74cf603">esp_gatt_value_t::handle</a></div><div class="ttdeci">uint16_t handle</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00370">esp_gatt_defs.h:370</a></div></div>
<div class="ttc" id="acomponents_2arduino-esp32_2tools_2sdk_2include_2newlib_2assert_8h_html_a7bbc469eb189fd98eead7ce1691dce53"><div class="ttname"><a href="components_2arduino-esp32_2tools_2sdk_2include_2newlib_2assert_8h.html#a7bbc469eb189fd98eead7ce1691dce53">assert</a></div><div class="ttdeci">#define assert(__e)</div><div class="ttdef"><b>Definition:</b> <a href="components_2arduino-esp32_2tools_2sdk_2include_2newlib_2assert_8h_source.html#l00017">assert.h:16</a></div></div>
<div class="ttc" id="astdint_8h_html_a2aff71146ab4942b2b38860c749c4074"><div class="ttname"><a href="stdint_8h.html#a2aff71146ab4942b2b38860c749c4074">uint8_t</a></div><div class="ttdeci">__uint8_t uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00021">stdint.h:21</a></div></div>
<div class="ttc" id="aclassGeneralUtils_html_a25e466e54ff002f54bfb7e1f43bd401b"><div class="ttname"><a href="classGeneralUtils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a></div><div class="ttdeci">static const char * errorToString(esp_err_t errCode)</div><div class="ttdoc">Convert an ESP error code to a string.</div><div class="ttdef"><b>Definition:</b> <a href="GeneralUtils_8cpp_source.html#l00369">GeneralUtils.cpp:369</a></div></div>
<div class="ttc" id="anamespaceudp__server_html_a4243778b598aedff036c5363970df861"><div class="ttname"><a href="namespaceudp__server.html#a4243778b598aedff036c5363970df861">udp_server.s</a></div><div class="ttdeci">s</div><div class="ttdef"><b>Definition:</b> <a href="udp__server_8py_source.html#l00007">udp_server.py:7</a></div></div>
<div class="ttc" id="aesp__gatt__defs_8h_html_a83259cd7465fba1aebeeaea5be774080"><div class="ttname"><a href="esp__gatt__defs_8h.html#a83259cd7465fba1aebeeaea5be774080">ESP_GATT_CHAR_PROP_BIT_READ</a></div><div class="ttdeci">#define ESP_GATT_CHAR_PROP_BIT_READ</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00281">esp_gatt_defs.h:280</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7">esp_gatts_cb_event_t</a></div><div class="ttdeci">esp_gatts_cb_event_t</div><div class="ttdoc">GATT Server callback function events.</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00027">esp_gatts_api.h:27</a></div></div>
<div class="ttc" id="astructesp__gatt__value__t_html_a706fd2f7eb96d73c7fd468f3edeb7e19"><div class="ttname"><a href="structesp__gatt__value__t.html#a706fd2f7eb96d73c7fd468f3edeb7e19">esp_gatt_value_t::len</a></div><div class="ttdeci">uint16_t len</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatt__defs_8h_source.html#l00372">esp_gatt_defs.h:372</a></div></div>
<div class="ttc" id="aesp__gatts__api_8h_html_ad091344ef95358eee0393aa5850965b7a51490e359d1ed9d395d338b97b2808b9"><div class="ttname"><a href="esp__gatts__api_8h.html#ad091344ef95358eee0393aa5850965b7a51490e359d1ed9d395d338b97b2808b9">ESP_GATTS_ADD_CHAR_EVT</a></div><div class="ttdeci">@ ESP_GATTS_ADD_CHAR_EVT</div><div class="ttdef"><b>Definition:</b> <a href="esp__gatts__api_8h_source.html#l00037">esp_gatts_api.h:37</a></div></div>
<div class="ttc" id="aBLEUtils_8h_html"><div class="ttname"><a href="BLEUtils_8h.html">BLEUtils.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
