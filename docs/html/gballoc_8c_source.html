<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>watch 2: components/arduino-esp32/libraries/AzureIoT/src/az_iot/c-utility/src/gballoc.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">watch 2
   </div>
   <div id="projectbrief">Firmwareforwatch2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_5eb99044ce905dee52e93bf33cea5db4.html">arduino-esp32</a></li><li class="navelem"><a class="el" href="dir_0b98385dcf64e929fcaa5e8c894594ea.html">libraries</a></li><li class="navelem"><a class="el" href="dir_eb555940be421b578cfc4731c861a40a.html">AzureIoT</a></li><li class="navelem"><a class="el" href="dir_540bbe64a9e668446da0d15e64e423e9.html">src</a></li><li class="navelem"><a class="el" href="dir_c4ba8e35b6f312a68ea59c6826b7e111.html">az_iot</a></li><li class="navelem"><a class="el" href="dir_31551b8d33ee157fa445c47622c5655a.html">c-utility</a></li><li class="navelem"><a class="el" href="dir_b7b3d73515064cc1b6d602999d01daa9.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gballoc.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gballoc_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) Microsoft. All rights reserved.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Licensed under the MIT license. See LICENSE file in the project root for full license information.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stdint_8h.html">stdint.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h.html">az_iot/c-utility/inc/azure_c_shared_utility/lock.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="optimize__size_8h.html">az_iot/c-utility/inc/azure_c_shared_utility/optimize_size.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xlogging_8h.html">az_iot/c-utility/inc/azure_c_shared_utility/xlogging.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef SIZE_MAX</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define SIZE_MAX ((size_t)~(size_t)0)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">   13</a></span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="structALLOCATION__TAG.html">   15</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structALLOCATION__TAG.html">ALLOCATION_TAG</a></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">   17</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">   18</a></span>&#160;    <span class="keywordtype">void</span>* <a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">   19</a></span>&#160;    <span class="keywordtype">void</span>* <a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="gballoc_8c.html#ab2b65b9a814fcb86d6692822fc876524">   20</a></span>&#160;} <a class="code" href="gballoc_8c.html#ab2b65b9a814fcb86d6692822fc876524">ALLOCATION</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4">   22</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4">GBALLOC_STATE_TAG</a></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">   24</a></span>&#160;    <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">GBALLOC_STATE_NOT_INIT</a></div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">   26</a></span>&#160;} <a class="code" href="gballoc_8c.html#a141abb06651ff7c03e8ba04acc04c5a8">GBALLOC_STATE</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">static</span> <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a> = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> totalSize = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> maxSize = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">static</span> <a class="code" href="gballoc_8c.html#a141abb06651ff7c03e8ba04acc04c5a8">GBALLOC_STATE</a> gballocState = <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">GBALLOC_STATE_NOT_INIT</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">static</span> <a class="code" href="libraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h.html#a83187a1340d2a8c817783e74f55d8281">LOCK_HANDLE</a> gballocThreadSafeLock = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a94e10dfbdf1023c2a6e662cfc67d3f3d">   35</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="gballoc_8c.html#a94e10dfbdf1023c2a6e662cfc67d3f3d">gballoc_init</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">int</span> result;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">GBALLOC_STATE_NOT_INIT</a>)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_025: [Init after Init shall fail and return a non-zero value.] */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        result = <a class="code" href="macro__utils_8h.html#aa8c798c7579b5c5a23a87b213f9accd6">__FAILURE__</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_026: [gballoc_Init shall create a lock handle that will be used to make the other gballoc APIs thread-safe.] */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((gballocThreadSafeLock = <a class="code" href="lock_8c.html#a3683432285e999baa8c543f27633829c">Lock_Init</a>()) == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_027: [If the Lock creation fails, gballoc_init shall return a non-zero value.]*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        result = <a class="code" href="macro__utils_8h.html#aa8c798c7579b5c5a23a87b213f9accd6">__FAILURE__</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        gballocState = <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">/* Codes_ SRS_GBALLOC_01_002: [Upon initialization the total memory used and maximum total memory used tracked by the module shall be set to 0.] */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        totalSize = 0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        maxSize = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_024: [gballoc_init shall initialize the gballoc module and return 0 upon success.] */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        result = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a81ae2fe2b3954b59cffe7e3a9528591e">   65</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gballoc_8c.html#a81ae2fe2b3954b59cffe7e3a9528591e">gballoc_deinit</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (gballocState == <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_028: [gballoc_deinit shall free all resources allocated by gballoc_init.] */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#ac9743d97f19aac4a0bda808e57ef1249">Lock_Deinit</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    gballocState = <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">GBALLOC_STATE_NOT_INIT</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="gballoc_8c.html#af9f831e4b7fc0f45da871372f184a46b">   76</a></span>&#160;<span class="keywordtype">void</span>* <a class="code" href="gballoc_8c.html#af9f831e4b7fc0f45da871372f184a46b">gballoc_malloc</a>(<span class="keywordtype">size_t</span> <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">void</span>* result;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_039: [If gballoc was not initialized gballoc_malloc shall simply call malloc without any memory tracking being performed.] */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a>(<a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_030: [gballoc_malloc shall ensure thread safety by using the lock created by gballoc_Init.] */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_048: [If acquiring the lock fails, gballoc_malloc shall return NULL.] */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* allocation = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)<a class="code" href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (allocation == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_003: [gb_malloc shall call the C99 malloc function and return its result.] */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a>(<a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (result == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_012: [When the underlying malloc call fails, gballoc_malloc shall return NULL and size should not be counted towards total memory used.] */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(allocation);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_004: [If the underlying malloc call is successful, gb_malloc shall increment the total memory used with the amount indicated by size.] */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> = result;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a> = <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a> = <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a> = allocation;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            totalSize += <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_011: [The maximum total memory used shall be the maximum of the total memory used at any point.] */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span> (maxSize &lt; totalSize)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                maxSize = totalSize;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a98d06a4ce513db4ad236980a3cd64224">  131</a></span>&#160;<span class="keywordtype">void</span>* <a class="code" href="gballoc_8c.html#a98d06a4ce513db4ad236980a3cd64224">gballoc_calloc</a>(<span class="keywordtype">size_t</span> nmemb, <span class="keywordtype">size_t</span> <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">void</span>* result;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_040: [If gballoc was not initialized gballoc_calloc shall simply call calloc without any memory tracking being performed.] */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#a84beef8cc122add35118ec7cd35286c4">calloc</a>(nmemb, <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_031: [gballoc_calloc shall ensure thread safety by using the lock created by gballoc_Init]  */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_046: [If acquiring the lock fails, gballoc_calloc shall return NULL.] */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* allocation = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)<a class="code" href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (allocation == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_020: [gballoc_calloc shall call the C99 calloc function and return its result.] */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#a84beef8cc122add35118ec7cd35286c4">calloc</a>(nmemb, <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (result == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_022: [When the underlying calloc call fails, gballoc_calloc shall return NULL and size should not be counted towards total memory used.] */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(allocation);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_021: [If the underlying calloc call is successful, gballoc_calloc shall increment the total memory used with nmemb*size.] */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> = result;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a> = nmemb * <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a> = <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a> = allocation;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            totalSize += allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_011: [The maximum total memory used shall be the maximum of the total memory used at any point.] */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">if</span> (maxSize &lt; totalSize)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                maxSize = totalSize;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="gballoc_8c.html#adbf9ed46b0e7ef19465907332cdcf538">  186</a></span>&#160;<span class="keywordtype">void</span>* <a class="code" href="gballoc_8c.html#adbf9ed46b0e7ef19465907332cdcf538">gballoc_realloc</a>(<span class="keywordtype">void</span>* <a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>, <span class="keywordtype">size_t</span> <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* curr;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">void</span>* result;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* allocation = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_041: [If gballoc was not initialized gballoc_realloc shall shall simply call realloc without any memory tracking being performed.] */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#a1b739878adcdb46fb5d209af7ce79628">realloc</a>(<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>, <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_032: [gballoc_realloc shall ensure thread safety by using the lock created by gballoc_Init.] */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_047: [If acquiring the lock fails, gballoc_realloc shall return NULL.] */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a> == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_017: [When ptr is NULL, gballoc_realloc shall call the underlying realloc with ptr being NULL and the realloc result shall be tracked by gballoc.] */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        allocation = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)<a class="code" href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        curr = <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">while</span> (curr != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">if</span> (curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> == <a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                allocation = curr;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                curr = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (allocation == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_015: [When allocating memory used for tracking by gballoc_realloc fails, gballoc_realloc shall return NULL and no change should be made to the counted total memory usage.] */</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_016: [When the ptr pointer cannot be found in the pointers tracked by gballoc, gballoc_realloc shall return NULL and the underlying realloc shall not be called.] */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        result = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        result = <a class="code" href="unity__fixture__malloc__overrides_8h.html#a1b739878adcdb46fb5d209af7ce79628">realloc</a>(<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>, <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> (result == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_014: [When the underlying realloc call fails, gballoc_realloc shall return NULL and no change should be made to the counted total memory usage.] */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a> == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(allocation);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a> != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">/* Codes_SRS_GBALLOC_01_006: [If the underlying realloc call is successful, gballoc_realloc shall look up the size associated with the pointer ptr and decrease the total memory used with that size.] */</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> = result;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                totalSize -= allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a> = <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="comment">/* add block */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> = result;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a> = <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                allocation-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a> = <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a> = allocation;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_007: [If realloc is successful, gballoc_realloc shall also increment the total memory used value tracked by this module.] */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            totalSize += <a class="code" href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_011: [The maximum total memory used shall be the maximum of the total memory used at any point.] */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">if</span> (maxSize &lt; totalSize)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                maxSize = totalSize;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a75f5eec95295dabcfa967175bd7f70e0">  280</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gballoc_8c.html#a75f5eec95295dabcfa967175bd7f70e0">gballoc_free</a>(<span class="keywordtype">void</span>* <a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* curr = <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>* prev = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_042: [If gballoc was not initialized gballoc_free shall shall simply call free.] */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_033: [gballoc_free shall ensure thread safety by using the lock created by gballoc_Init.] */</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_049: [If acquiring the lock fails, gballoc_free shall do nothing.] */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_009: [gballoc_free shall also look up the size associated with the ptr pointer and decrease the total memory used with the associated size amount.] */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">while</span> (curr != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">if</span> (curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ptr</a> == <a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="comment">/* Codes_SRS_GBALLOC_01_008: [gballoc_free shall call the C99 free function.] */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            totalSize -= curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">size</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (prev != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                prev-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a> = curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <a class="code" href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a> = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a>(curr);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        prev = curr;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        curr = (<a class="code" href="structALLOCATION__TAG.html">ALLOCATION</a>*)curr-&gt;<a class="code" href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">next</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> ((curr == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (<a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a> != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_019: [When the ptr pointer cannot be found in the pointers tracked by gballoc, gballoc_free shall not free any memory.] */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">/* could not find the allocation */</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Could not free allocation for address %p (not found)&quot;</span>, <a class="code" href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a91826597e0795d0d2690f7217459f7a6">  334</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="gballoc_8c.html#a91826597e0795d0d2690f7217459f7a6">gballoc_getMaximumMemoryUsed</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">size_t</span> result;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_038: [If gballoc was not initialized gballoc_getMaximumMemoryUsed shall return MAX_INT_SIZE.] */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;gballoc is not initialized.&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        result = <a class="code" href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_034: [gballoc_getMaximumMemoryUsed shall ensure thread safety by using the lock created by gballoc_Init.]  */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_050: [If the lock cannot be acquired, gballoc_getMaximumMemoryUsed shall return SIZE_MAX.]  */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        result = <a class="code" href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_010: [gballoc_getMaximumMemoryUsed shall return the maximum amount of total memory used recorded since the module initialization.] */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        result = maxSize;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="gballoc_8c.html#a2c010791d43325fb5d8d1cef76fa48b6">  361</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="gballoc_8c.html#a2c010791d43325fb5d8d1cef76fa48b6">gballoc_getCurrentMemoryUsed</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">size_t</span> result;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_044: [If gballoc was not initialized gballoc_getCurrentMemoryUsed shall return SIZE_MAX.] */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (gballocState != <a class="code" href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a>)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;gballoc is not initialized.&quot;</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        result = <a class="code" href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">/* Codes_SRS_GBALLOC_01_036: [gballoc_getCurrentMemoryUsed shall ensure thread safety by using the lock created by gballoc_Init.]*/</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOCK_OK != <a class="code" href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a>(gballocThreadSafeLock))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">/* Codes_SRS_GBALLOC_01_051: [If the lock cannot be acquired, gballoc_getCurrentMemoryUsed shall return SIZE_MAX.] */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a>(<span class="stringliteral">&quot;Failed to get the Lock.&quot;</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        result = <a class="code" href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">/*Codes_SRS_GBALLOC_02_001: [gballoc_getCurrentMemoryUsed shall return the currently used memory size.] */</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        result = totalSize;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        (<a class="code" href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a>)<a class="code" href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a>(gballocThreadSafeLock);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="agballoc_8c_html_a2c010791d43325fb5d8d1cef76fa48b6"><div class="ttname"><a href="gballoc_8c.html#a2c010791d43325fb5d8d1cef76fa48b6">gballoc_getCurrentMemoryUsed</a></div><div class="ttdeci">size_t gballoc_getCurrentMemoryUsed(void)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00361">gballoc.c:361</a></div></div>
<div class="ttc" id="amacro__utils_8h_html_aa8c798c7579b5c5a23a87b213f9accd6"><div class="ttname"><a href="macro__utils_8h.html#aa8c798c7579b5c5a23a87b213f9accd6">__FAILURE__</a></div><div class="ttdeci">#define __FAILURE__</div><div class="ttdef"><b>Definition:</b> <a href="macro__utils_8h_source.html#l00019">macro_utils.h:18</a></div></div>
<div class="ttc" id="aunity__fixture__malloc__overrides_8h_html_a84beef8cc122add35118ec7cd35286c4"><div class="ttname"><a href="unity__fixture__malloc__overrides_8h.html#a84beef8cc122add35118ec7cd35286c4">calloc</a></div><div class="ttdeci">#define calloc</div><div class="ttdef"><b>Definition:</b> <a href="unity__fixture__malloc__overrides_8h_source.html#l00039">unity_fixture_malloc_overrides.h:38</a></div></div>
<div class="ttc" id="agballoc_8c_html_a75f5eec95295dabcfa967175bd7f70e0"><div class="ttname"><a href="gballoc_8c.html#a75f5eec95295dabcfa967175bd7f70e0">gballoc_free</a></div><div class="ttdeci">void gballoc_free(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00280">gballoc.c:280</a></div></div>
<div class="ttc" id="astructALLOCATION__TAG_html"><div class="ttname"><a href="structALLOCATION__TAG.html">ALLOCATION_TAG</a></div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00015">gballoc.c:16</a></div></div>
<div class="ttc" id="agballoc_8c_html_adbf9ed46b0e7ef19465907332cdcf538"><div class="ttname"><a href="gballoc_8c.html#adbf9ed46b0e7ef19465907332cdcf538">gballoc_realloc</a></div><div class="ttdeci">void * gballoc_realloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00186">gballoc.c:186</a></div></div>
<div class="ttc" id="agballoc_8c_html_a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8"><div class="ttname"><a href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4a34a3d428db87e8fbff2733e3e27981c8">GBALLOC_STATE_INIT</a></div><div class="ttdeci">@ GBALLOC_STATE_INIT</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00024">gballoc.c:24</a></div></div>
<div class="ttc" id="aoptimize__size_8h_html"><div class="ttname"><a href="optimize__size_8h.html">optimize_size.h</a></div></div>
<div class="ttc" id="atie-asm_8h_html_affe32083c94bc4a11a45844dfc3c5751"><div class="ttname"><a href="tie-asm_8h.html#affe32083c94bc4a11a45844dfc3c5751">ptr</a></div><div class="ttdeci">macro xchal_ncp_store ptr at1 at2 at3 at4 ofs rur THREADPTR at1 s32i ptr</div><div class="ttdef"><b>Definition:</b> <a href="tie-asm_8h_source.html#l00082">tie-asm.h:82</a></div></div>
<div class="ttc" id="aRPSL_8txt_html_ae227cfd33a5880ffce840d383c2fbff3"><div class="ttname"><a href="RPSL_8txt.html#ae227cfd33a5880ffce840d383c2fbff3">free</a></div><div class="ttdeci">Conditions &amp;Restrictions Subject to the terms and conditions of this Licensor hereby grants effective on the date You accept this a royalty free</div><div class="ttdef"><b>Definition:</b> <a href="RPSL_8txt_source.html#l00105">RPSL.txt:105</a></div></div>
<div class="ttc" id="agballoc_8c_html_a46219b733c52dbe8aae75755f9af12d4"><div class="ttname"><a href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4">GBALLOC_STATE_TAG</a></div><div class="ttdeci">GBALLOC_STATE_TAG</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00022">gballoc.c:23</a></div></div>
<div class="ttc" id="agballoc_8c_html_ab2b65b9a814fcb86d6692822fc876524"><div class="ttname"><a href="gballoc_8c.html#ab2b65b9a814fcb86d6692822fc876524">ALLOCATION</a></div><div class="ttdeci">struct ALLOCATION_TAG ALLOCATION</div></div>
<div class="ttc" id="alibraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h_html_a83187a1340d2a8c817783e74f55d8281"><div class="ttname"><a href="libraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h.html#a83187a1340d2a8c817783e74f55d8281">LOCK_HANDLE</a></div><div class="ttdeci">void * LOCK_HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h_source.html#l00024">lock.h:24</a></div></div>
<div class="ttc" id="astructALLOCATION__TAG_html_a9d265cd003dd23e38b4fbb69f97e8f1c"><div class="ttname"><a href="structALLOCATION__TAG.html#a9d265cd003dd23e38b4fbb69f97e8f1c">ALLOCATION_TAG::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00018">gballoc.c:18</a></div></div>
<div class="ttc" id="agballoc_8c_html_af9f831e4b7fc0f45da871372f184a46b"><div class="ttname"><a href="gballoc_8c.html#af9f831e4b7fc0f45da871372f184a46b">gballoc_malloc</a></div><div class="ttdeci">void * gballoc_malloc(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00076">gballoc.c:76</a></div></div>
<div class="ttc" id="astructALLOCATION__TAG_html_a34586087e8207e51cc668aa12ad32cc2"><div class="ttname"><a href="structALLOCATION__TAG.html#a34586087e8207e51cc668aa12ad32cc2">ALLOCATION_TAG::next</a></div><div class="ttdeci">void * next</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00019">gballoc.c:19</a></div></div>
<div class="ttc" id="agballoc_8c_html_a94e10dfbdf1023c2a6e662cfc67d3f3d"><div class="ttname"><a href="gballoc_8c.html#a94e10dfbdf1023c2a6e662cfc67d3f3d">gballoc_init</a></div><div class="ttdeci">int gballoc_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00035">gballoc.c:35</a></div></div>
<div class="ttc" id="agballoc_8c_html_a141abb06651ff7c03e8ba04acc04c5a8"><div class="ttname"><a href="gballoc_8c.html#a141abb06651ff7c03e8ba04acc04c5a8">GBALLOC_STATE</a></div><div class="ttdeci">enum GBALLOC_STATE_TAG GBALLOC_STATE</div></div>
<div class="ttc" id="adef_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00071">def.h:70</a></div></div>
<div class="ttc" id="aArduino-IRremote_2LICENSE_8txt_html_a3b083519fd2b41d83363afcfd5ebad9d"><div class="ttname"><a href="Arduino-IRremote_2LICENSE_8txt.html#a3b083519fd2b41d83363afcfd5ebad9d">void</a></div><div class="ttdeci">if the work is an executable linked with the with the complete machine readable work that uses the as object code and or source so that the user can modify the Library and then relink to produce a modified executable containing the modified rather than copying library functions into the if the user installs as long as the modified version is interface compatible with the version that the work was made with c Accompany the work with a written valid for at least three to give the same user the materials specified in for a charge no more than the cost of performing this distribution d If distribution of the work is made by offering access to copy from a designated offer equivalent access to copy the above specified materials from the same place e Verify that the user has already received a copy of these materials or that you have already sent this user a copy For an the required form of the work that uses the Library must include any data and utility programs needed for reproducing the executable from it as a special the materials to be distributed need not include anything that is normally and so on of the operating system on which the executable unless that component itself accompanies the executable It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system Such a contradiction means you cannot use both them and the Library together in an executable that you distribute You may place library facilities that are a work based on the Library side by side in a single library together with other library facilities not covered by this and distribute such a combined provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise and provided that you do these two uncombined with any other library facilities This must be distributed under the terms of the Sections above b Give prominent notice with the combined library of the fact that part of it is a work based on the and explaining where to find the accompanying uncombined form of the same work You may not link or distribute the Library except as expressly provided under this License Any attempt otherwise to link or distribute the Library is void</div><div class="ttdef"><b>Definition:</b> <a href="Arduino-IRremote_2LICENSE_8txt_source.html#l00353">LICENSE.txt:353</a></div></div>
<div class="ttc" id="aunity__fixture__malloc__overrides_8h_html_acf143577800376dd931c059ecc61ba06"><div class="ttname"><a href="unity__fixture__malloc__overrides_8h.html#acf143577800376dd931c059ecc61ba06">malloc</a></div><div class="ttdeci">#define malloc</div><div class="ttdef"><b>Definition:</b> <a href="unity__fixture__malloc__overrides_8h_source.html#l00038">unity_fixture_malloc_overrides.h:37</a></div></div>
<div class="ttc" id="astdint_8h_html"><div class="ttname"><a href="stdint_8h.html">stdint.h</a></div></div>
<div class="ttc" id="agballoc_8c_html_a3c75bb398badb69c7577b21486f9963f"><div class="ttname"><a href="gballoc_8c.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a></div><div class="ttdeci">#define SIZE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00013">gballoc.c:12</a></div></div>
<div class="ttc" id="alock_8c_html_a3683432285e999baa8c543f27633829c"><div class="ttname"><a href="lock_8c.html#a3683432285e999baa8c543f27633829c">Lock_Init</a></div><div class="ttdeci">LOCK_HANDLE Lock_Init(void)</div><div class="ttdef"><b>Definition:</b> <a href="lock_8c_source.html#l00011">lock.c:11</a></div></div>
<div class="ttc" id="alibraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h_html"><div class="ttname"><a href="libraries_2AzureIoT_2src_2az__iot_2c-utility_2inc_2azure__c__shared__utility_2lock_8h.html">lock.h</a></div><div class="ttdoc">A minimalistic platform agnostic lock abstraction for thread synchronization.</div></div>
<div class="ttc" id="agballoc_8c_html_a81ae2fe2b3954b59cffe7e3a9528591e"><div class="ttname"><a href="gballoc_8c.html#a81ae2fe2b3954b59cffe7e3a9528591e">gballoc_deinit</a></div><div class="ttdeci">void gballoc_deinit(void)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00065">gballoc.c:65</a></div></div>
<div class="ttc" id="axlogging_8h_html_aec0857f05ae0368bb1cb6efdc63cd420"><div class="ttname"><a href="xlogging_8h.html#aec0857f05ae0368bb1cb6efdc63cd420">LogError</a></div><div class="ttdeci">#define LogError(FORMAT,...)</div><div class="ttdef"><b>Definition:</b> <a href="xlogging_8h_source.html#l00164">xlogging.h:163</a></div></div>
<div class="ttc" id="alock_8c_html_a146c21d68c41777d20ef1f7e30518505"><div class="ttname"><a href="lock_8c.html#a146c21d68c41777d20ef1f7e30518505">Lock</a></div><div class="ttdeci">LOCK_RESULT Lock(LOCK_HANDLE handle)</div><div class="ttdef"><b>Definition:</b> <a href="lock_8c_source.html#l00055">lock.c:55</a></div></div>
<div class="ttc" id="axlogging_8h_html"><div class="ttname"><a href="xlogging_8h.html">xlogging.h</a></div></div>
<div class="ttc" id="aunity__fixture__malloc__overrides_8h_html_a1b739878adcdb46fb5d209af7ce79628"><div class="ttname"><a href="unity__fixture__malloc__overrides_8h.html#a1b739878adcdb46fb5d209af7ce79628">realloc</a></div><div class="ttdeci">#define realloc</div><div class="ttdef"><b>Definition:</b> <a href="unity__fixture__malloc__overrides_8h_source.html#l00040">unity_fixture_malloc_overrides.h:39</a></div></div>
<div class="ttc" id="agballoc_8c_html_a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96"><div class="ttname"><a href="gballoc_8c.html#a46219b733c52dbe8aae75755f9af12d4ae9584ceabcf1c66f445f1f7dd6d14b96">GBALLOC_STATE_NOT_INIT</a></div><div class="ttdeci">@ GBALLOC_STATE_NOT_INIT</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00026">gballoc.c:25</a></div></div>
<div class="ttc" id="agballoc_8c_html_a98d06a4ce513db4ad236980a3cd64224"><div class="ttname"><a href="gballoc_8c.html#a98d06a4ce513db4ad236980a3cd64224">gballoc_calloc</a></div><div class="ttdeci">void * gballoc_calloc(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00131">gballoc.c:131</a></div></div>
<div class="ttc" id="acacheasm_8h_html_a296a4dfa224096b538c66a9bab58cb9e"><div class="ttname"><a href="cacheasm_8h.html#a296a4dfa224096b538c66a9bab58cb9e">size</a></div><div class="ttdeci">macro cache_index_all size</div><div class="ttdef"><b>Definition:</b> <a href="cacheasm_8h_source.html#l00158">cacheasm.h:158</a></div></div>
<div class="ttc" id="alock_8c_html_aef3dd970e9edfc49b414aa6cb0f3ad84"><div class="ttname"><a href="lock_8c.html#aef3dd970e9edfc49b414aa6cb0f3ad84">Unlock</a></div><div class="ttdeci">LOCK_RESULT Unlock(LOCK_HANDLE handle)</div><div class="ttdef"><b>Definition:</b> <a href="lock_8c_source.html#l00084">lock.c:84</a></div></div>
<div class="ttc" id="agballoc_8c_html_a91826597e0795d0d2690f7217459f7a6"><div class="ttname"><a href="gballoc_8c.html#a91826597e0795d0d2690f7217459f7a6">gballoc_getMaximumMemoryUsed</a></div><div class="ttdeci">size_t gballoc_getMaximumMemoryUsed(void)</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00334">gballoc.c:334</a></div></div>
<div class="ttc" id="alock_8c_html_ac9743d97f19aac4a0bda808e57ef1249"><div class="ttname"><a href="lock_8c.html#ac9743d97f19aac4a0bda808e57ef1249">Lock_Deinit</a></div><div class="ttdeci">LOCK_RESULT Lock_Deinit(LOCK_HANDLE handle)</div><div class="ttdef"><b>Definition:</b> <a href="lock_8c_source.html#l00036">lock.c:36</a></div></div>
<div class="ttc" id="astructALLOCATION__TAG_html_a15567474552927f2d139c6a200cad68f"><div class="ttname"><a href="structALLOCATION__TAG.html#a15567474552927f2d139c6a200cad68f">ALLOCATION_TAG::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="gballoc_8c_source.html#l00017">gballoc.c:17</a></div></div>
<div class="ttc" id="atag__strings_8h_html_a434acd167ada209c34621739b6b8c583"><div class="ttname"><a href="tag__strings_8h.html#a434acd167ada209c34621739b6b8c583">head</a></div><div class="ttdeci">head</div><div class="ttdef"><b>Definition:</b> <a href="tag__strings_8h_source.html#l00005">tag_strings.h:5</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
